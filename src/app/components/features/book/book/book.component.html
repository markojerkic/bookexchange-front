<div class="grid flex justify-content-center p-m-4">
  <p-card [header]="id? 'Uredite knjigu': 'Unesite novu knjigu'">
    <form [formGroup]="bookForm" class="p-fluid grid flex">
      <!-- Naslov knjige -->
      <div class="p-field col-12 lg:col-6">
        <span class="p-float-label">
            <input formControlName="title" id="title" pInputText type="text">
            <label for="title">Naslov knjige *</label>
        </span>
      </div>

      <div class="p-field col-12 lg:col-6">
          <span class="p-float-label">
            <input formControlName="isbn" id="isbn" pInputText type="text"/>
            <label for="isbn">ISBN *</label>
          </span>
        <small *ngIf="bookForm.get('isbn')?.dirty && bookForm.get('isbn')?.invalid" class="p-error">ISBN se već
          koristi</small>
      </div>

      <div class=" col-12 lg:col-6">
        <div class="p-field p-inputgroup" formGroupName="bookAuthor">
          <span>
            <p-button (onClick)="openNewAuthorDialog()" icon="pi pi-plus" pTooltip="Dodaj novog autora"></p-button>
          </span>
          <span class="p-float-label">
            <p-dropdown [autoDisplayFirst]="false"
                        [filter]="true"
                        [options]="(authors$ | async)!"
                        [showClear]="true"
                        appendTo="body"
                        formControlName="id"
                        id="author"
                        optionLabel="displayName"
                        optionValue="id">
            </p-dropdown>
            <label for="author">Autor *</label>
          </span>
        </div>
      </div>

      <div class=" col-12 lg:col-6">
        <div class="p-field p-inputgroup">
          <span>
            <p-button (onClick)="openNewGenreDialog()" icon="pi pi-plus" pTooltip="Dodaj novi žanr"></p-button>
          </span>
          <span class="p-float-label">
            <p-multiSelect [filter]="true"
                           [options]="(genres$ | async)!"
                           appendTo="body"
                           dataKey="id"
                           formControlName="genres"
                           id="genres"
                           optionLabel="name">
            </p-multiSelect>
            <label for="genres">Žanrovi *</label>
          </span>
        </div>
      </div>
    </form>

    <ng-template pTemplate="footer">
      <button (click)="submitBook()" [disabled]="!bookForm.valid || loading" [loading]="loading"
              label="Spremi knjigu"
              pButton
              type="submit"></button>
    </ng-template>
  </p-card>
</div>
